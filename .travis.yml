sudo: required
dist: trusty
language: python
python:
    - "3.5"
env:
    - AF_PATH=$HOME/TryOutTravis/arrayfire-3
    - LD_LIBRARY_PATH="$AF_PATH/lib"
    - PYTHON_PATH="$HOME/Bolt/:$PYTHON_PATH"

# command to install dependencies
before_install:
    - sudo apt-get update -qq
    - sudo apt-get install -qq build-essential git cmake libfreeimage-dev cmake-curses-gui
    - sudo apt-get install -qq libopenblas-dev libfftw3-dev liblapacke-dev libboost-all-dev
    - sudo apt-get install -qq libfontconfig1-dev
    - sudo apt-get install build-essential cmake cmake-curses-gui xorg-dev libglu1-mesa-dev libxinerama-dev libxcursor-dev
    - wget https://github.com/glfw/glfw/archive/3.1.2.zip -O glfw-3.1.2.zip
    - unzip glfw-3.1.2.zip
    - cd glfw-3.1.2
    - mkdir build
    - cd build
    - cmake .. -DBUILD_SHARED_LIBS=ON -DCMAKE_BUILD_TYPE=Release
    - make -j8
    - sudo make install
    - export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH 
    - cd ../../
    - wget http://arrayfire.s3.amazonaws.com/3.5.0/ArrayFire-v3.5.0_Linux_x86_64.sh
    - yes | bash ArrayFire-v3.5.0_Linux_x86_64.sh
    - export LD_LIBRARY_PATH=$HOME/TryOutTravis/arrayfire-3/lib:$LD_LIBRARY_PATH
    - echo $LD_LIBRARY_PATH
    - pip install virtualenv
    - virtualenv -p /usr/bin/python3 venv 
    - source venv/bin/activate
    - pip install arrayfire
    - python -m arrayfire.tests

install:
    - echo $LD_LIBRARY_PATH
    - pip3 install arrayfire

script:
    python3 -m arrayfire.tests